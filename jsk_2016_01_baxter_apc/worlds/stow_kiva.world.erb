<?xml version="1.0" ?>
<sdf version="1.4">
  <world name="default">
    <include>
      <uri>model://ground_plane</uri>
    </include>

    <include>
      <uri>model://sun</uri>
    </include>

    <include>
      <uri>model://kiva_pod</uri>
      <name>kiva_pod</name>
      <pose>1.44 0 0 0 0 1.57</pose>
    </include>

    <include>
      <uri>model://apc_order_bin</uri>
      <name>apc_order_bin</name>
      <pose>0.78 0 0.40 0 0 0</pose>
    </include>
    <include>
      <uri>model://apc_order_bin_stage</uri>
      <name>apc_order_bin_stage</name>
      <pose>0.75 0 0 0 0 0</pose>
    </include>

<!--
- champion_copper_plus_spark_plug
- cheezit_big_original
- crayola_64_ct
- dr_browns_bottle_brush
- elmers_washable_no_run_school_glue
- expo_dry_erase_board_eraser
- feline_greenies_dental_treats
- first_years_take_and_toss_straw_cup
- genuine_joe_plastic_stir_sticks
- highland_6539_self_stick_notes
- kong_air_dog_squeakair_tennis_ball
- kong_duck_dog_toy
- kong_sitting_frog_dog_toy
- kyjen_squeakin_eggs_plush_puppies
- laugh_out_loud_joke_book
- mark_twain_huckleberry_finn
- mead_index_cards
- mommys_helper_outlet_plugs
- munchkin_white_hot_duck_bath_toy
- oreo_mega_stuf
- paper_mate_12_count_mirado_black_warrior
- rolodex_jumbo_pencil_cup
- safety_works_safety_glasses
- sharpie_accent_tank_style_highlighters
- stanley_66_052
-->
<%
 require 'json'
open('../json/stow_layout_1.json') do |io|
 @bin_contents = JSON.load(io)
 end
 @bin = ['bin_A','bin_B','bin_C','bin_D','bin_E','bin_F','bin_G','bin_H','bin_I','bin_J','bin_K','bin_L']
 @locations = {
  'bin_A' => [1.22,  0.3, 1.65, 0.0, 0.0, 0.0],
  'bin_B' => [1.22,  0.0, 1.65, 0.0, 0.0, 0.0],
  'bin_C' => [1.22, -0.3, 1.65, 0.0, 0.0, 0.0],
  'bin_D' => [1.22,  0.3, 1.46, 0.0, 0.0, 0.0],
  'bin_E' => [1.22,  0.0, 1.46, 0.0, 0.0, 0.0],
  'bin_F' => [1.22, -0.3, 1.46, 0.0, 0.0, 0.0],
  'bin_G' => [1.22,  0.3, 1.17, 0.0, 0.0, 0.0],
  'bin_H' => [1.22,  0.0, 1.17, 0.0, 0.0, 0.0],
  'bin_I' => [1.22, -0.3, 1.17, 0.0, 0.0, 0.0],
  'bin_J' => [1.22,  0.3, 0.90, 0.0, 0.0, 0.0],
  'bin_K' => [1.22,  0.0, 0.90, 0.0, 0.0, 0.0],
  'bin_L' => [1.22, -0.3, 0.90, 0.0, 0.0, 0.0]
 }
 @corrections = [
    [-0.12,  0.04,  0.04, 0.0, 0.0, 0.0],
    [ 0.12, -0.04,  0.04, 0.0, 0.0, 0.0],
    [-0.12, -0.04, -0.04, 0.0, 0.0, 0.0],
    [ 0.12,  0.04, -0.04, 0.0, 0.0, 0.0],
    [  0.2, -0.04,   0.0, 0.0, 0.0, 0.0],
    [  0.2, -0.04,   0.0, 0.0, 0.0, 0.0],
    [-0.12,  0.04, -0.04, 0.0, 0.0, 0.0],
    [-0.12, -0.04,  0.04, 0.0, 0.0, 0.0],
    [ 0.12,  0.04,  0.04, 0.0, 0.0, 0.0],
    [ 0.12, -0.04, -0.04, 0.0, 0.0, 0.0]
 ]
 @rotate = [0.0,0.0,0.0,0.0,1.5,0.0]
 @item_rotate = [
  "cheezit_big_original",
  "mark_twain_huckleberry_finn",
  "laugh_out_loud_joke_book",
  "oreo_mega_stuf",
  "dr_browns_bottle_brush",
  "highland_6539_self_stick_notes",
  "feline_greenies_dental_treats",
  "crayola_64_ct",
  "mommys_helper_outlet_plugs",
  "rolodex_jumbo_pencil_cup",
  "munchkin_white_hot_duck_bath_toy",
  "first_years_take_and_toss_straw_cup",
  "elmers_washable_no_run_school_glue"
 ]
%>
<%# @locations = {
  'bin_A' => '1.25  0.3 1.6 0 0 0',
  'bin_B' => '1.25  0.0 1.6 0 0 0',
  'bin_C' => '1.25 -0.3 1.6 0 0 0',
  'bin_D' => '1.25  0.3 1.35 0 0 0',
  'bin_E' => '1.25  0.0 1.35 0 0 0',
  'bin_F' => '1.25 -0.3 1.35 0 0 0',
  'bin_G' => '1.25  0.3 1.1 0 0 0',
  'bin_H' => '1.25  0.0 1.1 0 0 0',
  'bin_I' => '1.25 -0.3 1.1 0 0 0',
  'bin_J' => '1.25  0.3 0.85 0 0 0',
  'bin_K' => '1.25  0.0 0.85 0 0 0',
  'bin_L' => '1.25 -0.3 0.85 0 0 0'
 }
%>
<%for bin in @bin%>
    <!-- <%=bin%> -->
    <% i = 0
    for item in @bin_contents["bin_contents"][bin] %>
        <!-- <%=item%> -->
        <%
        if @item_rotate.include?(item) then
          location = [@locations[bin],@corrections[i],@rotate].transpose.map{|a| a.inject(:+)}.join(" ")
        else
          location = [@locations[bin],@corrections[i]].transpose.map{|a| a.inject(:+)}.join(" ")
        end
        i = i + 1
        %>
        <include>
            <uri>model://<%=item%></uri>
            <name><%=item%></name>
            <pose><%=location%></pose>
        </include>
   <%end%>
<%end%>
<%
 @locations = [
  '0.79  0.1  0.5 0 0 0',
  '0.79  -0.1  0.5 0 0 0',
  '0.77  -0.1  0.5 0 0 0',
  '0.77  0.1  0.5 0 0 0',
  '0.79  0.1 0.6 0 0 0',
  '0.78  -0.1  0.6 0 0 0',
  '0.77  0.1  0.6 0 0 0',
  '0.79  0.1  0.7 0 0 0',
  '0.79  -0.1  0.7 0 0 0',
  '0.77  -0.1  0.7 0 0 0',
  '0.77  0.1  0.7 0 0 0',
  '0.78  0.0  0.8 0 0 0'
]
%>

<%@bin_contents["work_order"].zip(@locations).each do |item,loc|%>
    <!-- <%=item%>-->
    <include>
      <uri>model://<%=item%></uri>
      <name><%=item%></name>
      <pose><%=loc%></pose>
    </include>
<%end%>

    <physics type="ode">
      <real_time_update_rate>1000.0</real_time_update_rate>
      <gravity>
        0.0 0.0 -9.81
      </gravity>
    </physics>
    <gui fullscreen='0'>
      <camera name='user_camera'>
        <pose>-1.14276 -2.86108 1.56989 0 0.219643 0.980195</pose>
        <view_controller>orbit</view_controller>
      </camera>
    </gui>
  </world>
</sdf>
