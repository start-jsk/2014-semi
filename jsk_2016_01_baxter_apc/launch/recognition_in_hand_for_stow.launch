<launch>
  <arg name="NODELET_MANAGER" />
  <arg name="INPUT_CLOUD" />
  <arg name="NODELET_ID_7" />

  <!-- self filter -->
  <include file="$(find jsk_2016_01_baxter_apc)/launch/include/self_filter.launch">
    <arg name="INPUT_CLOUD" value="extract_indices_left_hand/points" />
    <arg name="OUTPUT_CLOUD" value="extract_indices_left_hand/points_filtered" />
  </include>
  <include file="$(find jsk_2016_01_baxter_apc)/launch/include/self_filter.launch">
    <arg name="INPUT_CLOUD" value="extract_indices_right_hand/points" />
    <arg name="OUTPUT_CLOUD" value="extract_indices_right_hand/points_filtered" />
  </include>

  <group ns="$(arg NODELET_MANAGER)">
    <rosparam subst_value="true">
      nodelets_$(arg NODELET_ID_7):
        - name: in_hand_clipper
          type: jsk_pcl/AttentionClipper
          remappings:
            - from: ~input/points
              to: $(arg INPUT_CLOUD)
        - name: extract_indices_left_hand
          type: jsk_pcl/ExtractIndices
          remappings:
            - from: ~input
              to: $(arg INPUT_CLOUD)
            - from: ~indices
              to: /in_hand_clipper/left_hand/point_indices
            - from: ~output
              to: ~points
        - name: extract_indices_right_hand
          type: jsk_pcl/ExtractIndices
          remappings:
            - from: ~input
              to: $(arg INPUT_CLOUD)
            - from: ~indices
              to: /in_hand_clipper/right_hand/point_indices
            - from: ~output
              to: ~points
        - name: euclid_clustering_left_hand
          type: jsk_pcl/EuclideanClustering
          remappings:
            - from: ~input
              to: extract_indices_left_hand/points_filtered
        - name: euclid_clustering_right_hand
          type: jsk_pcl/EuclideanClustering
          remappings:
            - from: ~input
              to: extract_indices_right_hand/points_filtered
        - name: cpi_decomposer_left_hand
          type: jsk_pcl/ClusterPointIndicesDecomposer
          remappings:
            - from: ~input
              to: extract_indices_left_hand/points_filtered
            - from: ~target
              to: euclid_clustering_left_hand/output
        - name: cpi_decomposer_right_hand
          type: jsk_pcl/ClusterPointIndicesDecomposer
          remappings:
            - from: ~input
              to: extract_indices_right_hand/points_filtered
            - from: ~target
              to: euclid_clustering_right_hand/output
    </rosparam>
  </group>
  <group ns="in_hand_clipper">
    <rosparam>
      use_multiple_attention: true
      initial_pos_list: [[0.0, -0.1, 0.3], [0.0, 0.0, 0.15]]
      initial_rot_list: [[0, 0, 0], [0, 0, 0]]
      dimensions: [[0.3, 0.2, 0.3], [0.3, 0.3, 0.5]]
      frame_id_list: [left_custom_vacuum_link_base, right_gripper_vacuum_pad]
      prefixes: [left_hand, right_hand]
    </rosparam>
  </group>

  <group ns="extract_indices_left_hand">
    <rosparam>
      max_queue_size: 50
      keep_organized: true
    </rosparam>
  </group>
  <group ns="extract_indices_right_hand">
    <rosparam>
      max_queue_size: 50
      keep_organized: true
    </rosparam>
  </group>
  <group ns="euclid_clustering_left_hand">
    <rosparam>
      tolerance: 0.02
      min_size: 500
      max_size: 100000
    </rosparam>
  </group>
  <group ns="euclid_clustering_right_hand">
    <rosparam>
      tolerance: 0.02
      min_size: 500
      max_size: 100000
    </rosparam>
  </group>
  <group ns="cpi_decomposer_left_hand">
    <rosparam>
      queue_size: 1000
    </rosparam>
  </group>
  <group ns="cpi_decomposer_right_hand">
    <rosparam>
      queue_size: 1000
    </rosparam>
  </group>


</launch>
